# 로또 645 데이터 분석 프로젝트

## 📋 프로젝트 개요

로또 645 복권의 과거 당첨 데이터(601회~1203회, 2014.6.7~2025.12.20)를 Python으로 종합 분석하는 프로젝트입니다.

**작성일**: 2025-12-27
**데이터 범위**: 601회차 ~ 1203회차 (총 602회차)
**분석 도구**: Python 3.x, pandas, matplotlib, seaborn

---

## 🗂️ 프로젝트 구조

```
lotter645_1227/
├── Data/
│   └── 645_251227.csv          # 로또 데이터 원본 파일
├── src/
│   ├── data_loader.py          # 데이터 로드 및 전처리
│   ├── basic_stats.py          # 기본 통계 분석
│   ├── time_series.py          # 시계열 분석
│   ├── pattern_analysis.py     # 조합 패턴 분석
│   ├── prize_analysis.py       # 당첨금 분석
│   ├── consecutive_analysis.py # 연속 번호 상세 분석
│   ├── grid_pattern_analysis.py # 🎨 그리드 패턴 분석 ⭐ NEW
│   ├── prediction_model.py     # 🤖 머신러닝 예측 모델
│   ├── recommendation_system.py # 🎯 번호 추천 시스템
│   ├── generate_lottery_ticket.py # 복권 용지 이미지 생성 ⭐ NEW
│   ├── batch_generate_tickets.py # 복권 용지 일괄 생성 ⭐ NEW
│   ├── visualization.py        # 시각화 (15개 차트)
│   ├── web_app.py             # 🌐 Streamlit 웹 앱 (6페이지) ⭐
│   └── main.py                # CLI 메인 실행 스크립트
├── images/                    # 복권 용지 이미지 (604개) ⭐ NEW
├── output/
│   ├── charts/                # 차트 이미지 저장 폴더 (18개) ⭐
│   └── reports/               # 분석 리포트 저장 폴더 ⭐
├── venv/                      # 가상환경 (setup.sh 실행 시 생성)
├── setup.sh                   # 가상환경 설정 스크립트
├── run.sh                     # CLI 실행 스크립트
├── run_web.sh                 # 웹 앱 실행 스크립트
├── requirements.txt           # 필수 패키지 목록
├── README.md                  # 사용자 가이드
└── claude.md                  # 작업 문서 (본 파일)
```

---

## 🔧 설치 및 실행 방법

### 방법 1: 자동 설정 스크립트 사용 (권장)

#### 1단계: 가상환경 설정
```bash
chmod +x setup.sh
./setup.sh
```

이 스크립트는 자동으로:
- Python 버전 확인
- 가상환경(venv) 생성
- pip 업그레이드
- 필수 패키지 설치

#### 2단계: 프로그램 실행

**웹 앱 실행 (권장):**
```bash
./run_web.sh
```
브라우저가 자동으로 열리며 `http://localhost:8501`에서 인터랙티브 웹 인터페이스를 사용할 수 있습니다.

**CLI 실행:**
```bash
./run.sh
```

또는 직접 실행:
```bash
source venv/bin/activate
cd src && python main.py
```

### 방법 2: 수동 설정

#### 1. 가상환경 생성
```bash
python3 -m venv venv
```

#### 2. 가상환경 활성화
```bash
source venv/bin/activate  # macOS/Linux
# 또는
venv\Scripts\activate  # Windows
```

#### 3. 필수 패키지 설치
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

#### 4. 프로그램 실행
```bash
cd src
python main.py
```

#### 5. 가상환경 종료
```bash
deactivate
```

---

## 📊 구현된 분석 기능

### 1️⃣ 데이터 로드 및 전처리 (`data_loader.py`)

**주요 기능:**
- CSV 데이터 로드 (인코딩 자동 처리)
- 숫자 데이터 전처리 (쉼표 제거, 타입 변환)
- 당첨번호 추출 및 구조화
- 데이터 요약 정보 제공

**클래스:**
- `LottoDataLoader`: 데이터 로딩 및 전처리 담당

**주요 메서드:**
- `load_data()`: CSV 파일 읽기
- `preprocess()`: 데이터 정제 및 타입 변환
- `extract_numbers()`: 당첨번호 추출
- `get_all_numbers_flat()`: 모든 번호를 1차원 리스트로 반환
- `get_summary()`: 데이터 요약 출력

---

### 2️⃣ 기본 통계 분석 (`basic_stats.py`)

**분석 항목:**

1. **번호별 출현 빈도**
   - 1~45번 각 번호의 출현 횟수 및 출현율
   - 최다/최소 출현 번호 식별
   - 보너스 번호 포함 옵션

2. **구간별 분석**
   - 저구간(1-15), 중구간(16-30), 고구간(31-45) 출현 비율

3. **홀수/짝수 분석**
   - 홀수/짝수 출현 비율
   - 회차별 홀짝 개수 분포

4. **연속 번호 분석**
   - 회차별 연속 번호 쌍 개수 통계

5. **당첨번호 합계 분석**
   - 평균, 중앙값, 최소/최대값, 표준편차
   - 합계 구간별 분포

**클래스:**
- `BasicStats`

**주요 메서드:**
- `number_frequency()`: 번호별 빈도 분석
- `section_analysis()`: 구간별 분석
- `odd_even_analysis()`: 홀짝 분석
- `consecutive_analysis()`: 연속 번호 분석
- `sum_analysis()`: 합계 분석
- `run_all()`: 모든 기본 통계 실행

---

### 3️⃣ 시계열 분석 (`time_series.py`)

**분석 항목:**

1. **최근 핫넘버/콜드넘버**
   - 최근 50회/100회 기준 번호별 출현 빈도
   - 최다/최소 출현 번호 TOP 10

2. **번호 출현 간격 분석**
   - 특정 번호의 평균 출현 간격
   - 최근 출현 정보 및 미출현 기간

3. **장기 미출현 번호**
   - 가장 오랫동안 나오지 않은 번호 TOP 10

4. **이동 평균 빈도 분석**
   - 100회 윈도우 기준 번호별 트렌드 변화
   - 상승세/하락세 번호 TOP 10

**클래스:**
- `TimeSeriesAnalysis`

**주요 메서드:**
- `recent_hot_cold_numbers()`: 핫넘버/콜드넘버 분석
- `number_appearance_interval()`: 특정 번호 간격 분석
- `long_missing_numbers()`: 장기 미출현 번호
- `rolling_frequency()`: 이동 평균 트렌드
- `run_all()`: 모든 시계열 분석 실행

---

### 4️⃣ 조합 패턴 분석 (`pattern_analysis.py`)

**분석 항목:**

1. **2개 번호 조합 빈도**
   - 함께 자주 나오는 번호 쌍 TOP 20

2. **3개 번호 조합 빈도**
   - 함께 자주 나오는 번호 트리플 TOP 15

3. **번호 동반 출현 분석**
   - 특정 번호와 함께 나오는 번호 TOP 10

4. **당첨번호 합계 상세 분포**
   - 10 단위 구간별 분포

5. **AC값 (복잡도) 분석**
   - AC값 분포 및 통계
   - AC값: 번호 간 차이값의 고유 개수 - 5

6. **구간별 조합 패턴**
   - 저-중-고 구간 개수 조합 (예: 2-2-2, 1-3-2 등)

**클래스:**
- `PatternAnalysis`

**주요 메서드:**
- `pair_frequency()`: 2개 조합 분석
- `triplet_frequency()`: 3개 조합 분석
- `number_correlation()`: 동반 출현 분석
- `sum_distribution_detail()`: 합계 상세 분포
- `ac_value_analysis()`: AC값 분석
- `section_pattern_analysis()`: 구간 패턴 분석
- `run_all()`: 모든 패턴 분석 실행

---

### 5️⃣ 당첨금 분석 (`prize_analysis.py`)

**분석 항목:**

1. **1등 당첨금 통계**
   - 평균, 중앙값, 최소/최대, 표준편차
   - 최고 당첨금 회차 정보

2. **연도별 당첨금 추이**
   - 연도별 평균/최대/최소 당첨금

3. **1등 당첨자 수 분석**
   - 평균, 중앙값, 최소/최대
   - 당첨자 수 구간별 분포

4. **당첨금과 당첨자 수의 상관관계**
   - 상관계수 계산
   - 당첨자 수별 평균 당첨금

5. **총 판매액 추정**
   - 1등 당첨금 기반 판매액 역산
   - 최근 10회차 추정 판매액

**클래스:**
- `PrizeAnalysis`

**주요 메서드:**
- `first_prize_stats()`: 1등 당첨금 통계
- `prize_by_year()`: 연도별 추이
- `winner_count_analysis()`: 당첨자 수 분석
- `prize_vs_winners_correlation()`: 상관관계 분석
- `total_sales_estimation()`: 판매액 추정
- `run_all()`: 모든 당첨금 분석 실행

---

### 6️⃣ 연속 번호 상세 분석 (`consecutive_analysis.py`) ⭐ NEW

**분석 항목:**

1. **연속 번호 길이별 출현 빈도**
   - 연속 없음, 연속 2개, 3개, 4개 이상의 출현 통계
   - 전체 603회차 중 각 패턴의 출현 빈도 및 비율

2. **구체적인 연속 번호 조합 분석**
   - 가장 많이 나온 연속 번호 조합 TOP 20
   - 예: 6-7, 38-39, 17-18 등

3. **연속 길이별 상위 조합**
   - 연속 2개, 3개, 4개 각각의 TOP 조합
   - 출현 횟수 및 비율

4. **구간별 연속 번호 패턴**
   - 저구간(1-15), 중구간(16-30), 고구간(31-45)별 연속 조합
   - 각 구간에서 가장 많이 나온 연속 번호

5. **특이 케이스 찾기**
   - 연속 4개 이상 출현 회차 (매우 희귀)
   - 여러 연속 그룹이 동시 출현한 회차
   - 역사적으로 특별한 사례들

**주요 발견:**
- 연속 2개 출현: 56.22% (가장 흔한 패턴)
- 연속 3개 출현: 4.98% (드묾)
- 연속 4개 출현: 0.50% (매우 희귀, 총 3회)
- 연속 5개 이상: 0% (한 번도 없음)

**최다 출현 연속 조합:**
1. 6-7: 15회 (2.49%)
2. 38-39: 14회 (2.32%)
3. 17-18: 14회 (2.32%)
4. 3-4, 14-15: 각 12회 (1.99%)

**클래스:**
- `ConsecutiveNumberAnalysis`

**주요 메서드:**
- `find_consecutive_groups()`: 연속 번호 그룹 찾기
- `analyze_consecutive_patterns()`: 연속 패턴 상세 분석
- `analyze_patterns_by_section()`: 구간별 연속 패턴
- `find_interesting_cases()`: 특이 케이스 찾기
- `plot_consecutive_distribution()`: 연속 길이별 분포 차트
- `plot_consecutive_trend()`: 연속 번호 출현 추이 차트
- `plot_top_consecutive_combos()`: TOP 조합 차트
- `run_all()`: 모든 연속 번호 분석 실행

**실행 방법:**
```bash
cd src
source ../venv/bin/activate
python consecutive_analysis.py
```

---

### 7️⃣ 그리드 패턴 분석 (`grid_pattern_analysis.py`) ⭐ NEW

**분석 개요:**
복권 용지의 **7x7 그리드 배치**를 기반으로 당첨번호의 공간적 분포를 분석합니다.
숫자가 아닌 **위치**라는 새로운 관점에서 로또를 분석하는 독창적인 방법입니다.

**그리드 구조:**
```
[ 1][ 2][ 3][ 4][ 5][ 6][ 7]
[ 8][ 9][10][11][12][13][14]
[15][16][17][18][19][20][21]
[22][23][24][25][26][27][28]
[29][30][31][32][33][34][35]
[36][37][38][39][40][41][42]
[43][44][45][  ][  ][  ][  ]
```

**분석 항목:**

1. **위치별 출현 빈도**
   - 7x7 그리드 각 위치의 출현 횟수 히트맵
   - 최다/최소 출현 위치 식별
   - 평균 출현 횟수 통계

2. **구역별 분포**
   - 모서리(4칸), 가장자리(20칸), 중간(12칸), 중앙부(9칸)로 구분
   - 각 구역의 출현 빈도 및 1칸당 평균 출현 횟수
   - 구역별 선호도 분석

3. **기하학적 패턴**
   - 주 대각선 vs 반대 대각선 출현 비교
   - 같은 가로줄/세로줄에 3개 이상 출현 통계
   - 라인 패턴 분석

4. **공간적 군집도**
   - 당첨번호들 간의 맨해튼 거리 계산
   - 평균 거리 통계 (평균, 중앙값, 최소/최대)
   - 가장 군집된 회차 vs 가장 분산된 회차 TOP 5

**주요 발견:**

- **최다 출현 위치**: Row 1, Col 4 (번호 12) - 97회
- **최소 출현 위치**: Row 0, Col 4 (번호 5) - 64회
- **평균 출현**: 74.0회/번호

**구역별 통계:**
| 구역 | 칸 수 | 출현 횟수 | 비율 | 1칸당 평균 |
|------|-------|----------|------|------------|
| 모서리 | 4칸 | 246회 | 6.79% | 61.5회 ❌ |
| 가장자리 | 20칸 | 1,353회 | 37.33% | 67.7회 |
| 중간 | 12칸 | 1,299회 | 35.84% | 108.3회 ✅ |
| 중앙부 | 9칸 | 726회 | 20.03% | 80.7회 |

**핵심 인사이트:**
- 중간 영역(12칸)이 1칸당 평균 108.3회로 가장 높은 출현율!
- 모서리 4칸(1, 7, 43, 45번)은 상대적으로 저조
- 반대 대각선이 주 대각선보다 0.19개 더 많이 출현
- 평균 거리 4.51 (적절한 분산)

**실전 활용 전략:**

✅ **추천**:
1. 중간 영역 집중: 16-27, 31-34번 우선
2. 반대 대각선 활용: 7, 13, 19, 25, 31, 37, 43 중 1-2개
3. 같은 줄 2-3개: 한 가로줄에서 2-3개 선택 (21% 확률)
4. 평균 거리 4-5: 적절한 분산 유지

❌ **주의**:
1. 모서리 번호 지양: 1, 7, 43, 45번은 1개 이하
2. 극단적 군집 피하기: 평균 거리 2.0 이하
3. 같은 줄 4개 이상 피하기: 매우 드묾 (0.7%)
4. 극단적 분산 피하기: 평균 거리 6.0 이상

**클래스:**
- `GridPatternAnalysis`

**주요 메서드:**
- `get_position()`: 번호의 그리드 좌표 반환
- `get_zone()`: 그리드 위치의 구역 반환
- `analyze_position_frequency()`: 위치별 출현 빈도 분석
- `analyze_zone_distribution()`: 구역별 분포 분석
- `analyze_geometric_patterns()`: 기하학적 패턴 분석
- `analyze_spatial_clustering()`: 공간적 군집도 분석
- `plot_position_heatmap()`: 위치별 히트맵 차트
- `plot_zone_distribution()`: 구역별 분포 차트
- `plot_clustering_distribution()`: 군집도 분포 차트
- `run_all()`: 모든 그리드 패턴 분석 실행

**실행 방법:**
```bash
cd src
source ../venv/bin/activate
python grid_pattern_analysis.py
```

**생성 차트 (3개):**
- `grid_position_heatmap.png` (221KB)
- `grid_zone_distribution.png` (115KB)
- `grid_clustering.png` (436KB)

**관련 리포트:**
- `output/reports/grid_pattern_analysis_report.md`

---

### 8️⃣ 시각화 (`visualization.py`) - 확장됨 ⭐

**생성되는 차트 (총 15개):**

#### 기본 통계 차트 (6개)

1. **number_frequency.png** (91KB)
   - 번호별 출현 빈도 막대 그래프
   - 1~45번 모든 번호의 출현 횟수
   - 평균선 표시, 최다/최소 번호 색상 강조

2. **section_distribution.png** (109KB)
   - 구간별 분포 파이 차트
   - 저/중/고 구간 비율

3. **odd_even_distribution.png** (81KB)
   - 홀짝 분포 파이 차트
   - 홀수/짝수 비율

4. **sum_distribution.png** (67KB)
   - 당첨번호 합계 히스토그램
   - 평균/중앙값 선 표시

5. **number_heatmap.png** (189KB)
   - 번호 출현 히트맵
   - 최근 100회차를 10회씩 나누어 출현 패턴 시각화

6. **first_prize_trend.png** (385KB)
   - 1등 당첨금 추이 라인 차트
   - 회차별 당첨금 변화

#### 시계열 분석 차트 (3개) ⭐ NEW

7. **hot_cold_comparison.png** (171KB)
   - 핫넘버/콜드넘버 비교 차트
   - 최근 50회/100회/전체 기간 3단 비교

8. **number_interval.png** (82KB)
   - 번호별 평균 출현 간격 막대 그래프
   - 각 번호의 평균 출현 주기

9. **missing_periods.png** (95KB)
   - 번호별 미출현 기간 차트
   - 색상으로 구분 (20회 이상/10-20회/10회 미만)

#### 조합 패턴 분석 차트 (1개) ⭐ NEW

10. **pair_correlation_heatmap.png** (152KB)
    - 번호 간 동반 출현 히트맵
    - 45x45 매트릭스로 모든 번호 쌍의 동반 출현 횟수 시각화

#### 당첨금 분석 차트 (2개) ⭐ NEW

11. **prize_vs_winners.png** (338KB)
    - 당첨금과 당첨자 수의 관계 산점도
    - 추세선 및 상관계수 표시

12. **yearly_prize_boxplot.png** (165KB)
    - 연도별 당첨금 분포 박스플롯
    - 2014-2025년 당첨금 추이 및 분포

#### 연속 번호 분석 차트 (3개) ⭐ NEW

13. **consecutive_distribution.png** (195KB)
    - 연속 번호 길이별 분포
    - 막대 그래프 + 파이 차트

14. **consecutive_trend.png** (150KB)
    - 최근 200회차 연속 번호 출현 추이
    - 시계열 산점도

15. **consecutive_top_combos.png** (197KB)
    - 가장 많이 나온 연속 번호 조합 TOP 20
    - 가로 막대 그래프

**클래스:**
- `LottoVisualization`: 메인 시각화 (12개 차트)
- `ConsecutiveNumberAnalysis`: 연속 번호 시각화 (3개 차트)

**주요 메서드:**
- `plot_number_frequency()`: 번호 빈도 차트
- `plot_section_distribution()`: 구간 분포 차트
- `plot_odd_even_distribution()`: 홀짝 분포 차트
- `plot_sum_distribution()`: 합계 분포 차트
- `plot_heatmap()`: 히트맵 차트
- `plot_hot_cold_comparison()`: 핫넘버/콜드넘버 비교 ⭐
- `plot_number_interval()`: 번호별 출현 간격 ⭐
- `plot_missing_periods()`: 미출현 기간 ⭐
- `plot_pair_correlation_heatmap()`: 번호 쌍 상관관계 ⭐
- `plot_first_prize_trend()`: 당첨금 추이 차트
- `plot_prize_vs_winners()`: 당첨금-당첨자 관계 ⭐
- `plot_yearly_prize_boxplot()`: 연도별 당첨금 분포 ⭐
- `plot_all()`: 모든 차트 생성

**출력 위치:** `output/charts/` (총 1.9MB)

---

### 8️⃣ 메인 실행 스크립트 (`main.py`)

**기능:**
- 인터랙티브 메뉴 시스템
- 8가지 분석 옵션 제공

**메뉴 옵션:**

1. 전체 분석 실행 (모든 분석 + 시각화)
2. 기본 통계 분석만
3. 시계열 분석만
4. 조합 패턴 분석만
5. 당첨금 분석만
6. 시각화만
7. 특정 번호 분석 (사용자 입력)
8. 종료

**주요 함수:**
- `print_banner()`: 프로그램 배너 출력
- `print_menu()`: 메뉴 출력
- `run_full_analysis()`: 전체 분석 실행
- `analyze_specific_number()`: 특정 번호 상세 분석
- `main()`: 메인 루프

---

## 📈 주요 분석 결과

### 기본 통계

#### 번호별 출현 빈도 (상위 10개)

| 순위 | 번호 | 출현횟수 | 출현율(%) |
|------|------|----------|-----------|
| 1 | 12 | 97회 | 16.09% |
| 2 | 33 | 96회 | 15.92% |
| 3 | 21 | 94회 | 15.59% |
| 3 | 16 | 94회 | 15.59% |
| 5 | 38 | 92회 | 15.26% |
| 5 | 6 | 92회 | 15.26% |
| 5 | 7 | 92회 | 15.26% |
| 8 | 18 | 91회 | 15.09% |
| 9 | 19 | 90회 | 14.93% |
| 10 | 13 | 89회 | 14.76% |

**최소 출현:** 5번 (64회, 10.61%)

#### 구간별 분포

| 구간 | 출현횟수 | 비율(%) |
|------|----------|---------|
| 저구간 (1-15) | 1,211회 | 33.47% |
| 중구간 (16-30) | 1,194회 | 33.00% |
| 고구간 (31-45) | 1,213회 | 33.53% |

**인사이트:** 모든 구간이 거의 균등하게 분포 (약 33%씩)

#### 홀수/짝수 분포

| 구분 | 출현횟수 | 비율(%) |
|------|----------|---------|
| 홀수 | 1,862회 | 51.46% |
| 짝수 | 1,756회 | 48.54% |

---

### 시계열 분석

#### 최근 50회 핫넘버 TOP 5

| 번호 | 출현횟수 | 출현율(%) |
|------|----------|-----------|
| 3, 7, 16, 27, 39 | 10회 | 20.0% |

#### 최근 50회 콜드넘버 TOP 3

| 번호 | 출현횟수 | 출현율(%) |
|------|----------|-----------|
| 10, 44 | 3회 | 6.0% |
| 2, 14, 22, 34, 43 | 4회 | 8.0% |

#### 장기 미출현 TOP 3

| 번호 | 미출현 기간 | 최근 출현 |
|------|------------|----------|
| 44 | 24회차 | 1179회 |
| 42 | 16회차 | 1187회 |
| 22 | 15회차 | 1188회 |

---

### 조합 패턴 분석

#### 2개 번호 조합 TOP 5

| 순위 | 번호쌍 | 출현횟수 | 출현율(%) |
|------|--------|----------|-----------|
| 1 | 7-19 | 19회 | 3.15% |
| 2 | 3-13, 11-21, 21-35, 11-17, 12-42, 6-38, 19-21 | 18회 | 2.99% |

#### AC값 (복잡도)

- **평균 AC값**: 7.95
- **최빈 AC값**: 8 (35.82% 출현)
- **해석**: 번호가 비교적 고르게 분포

#### 구간 패턴 (저-중-고)

| 패턴 | 출현횟수 | 비율(%) |
|------|----------|---------|
| 2-2-2 | 86회 | 14.26% |
| 3-1-2 | 61회 | 10.12% |
| 2-3-1 | 54회 | 8.96% |

---

### 당첨금 분석

#### 1등 당첨금 통계

- **평균 당첨금**: 23억 3,499만원
- **중앙값**: 21억 1,437만원
- **최고 당첨금**: 123억 6,174만원 (1018회, 2022.06.04)
- **최저 당첨금**: 4억 1,993만원

#### 당첨금-당첨자 수 상관관계

- **상관계수**: -0.671 (중간 정도의 음의 상관)
- **해석**: 당첨자가 많을수록 당첨금이 감소하는 경향

---

### 연속 번호 분석 ⭐ NEW

#### 연속 번호 출현 빈도

| 연속 길이 | 출현횟수 | 비율(%) |
|-----------|----------|---------|
| **연속 없음** | 278회 | 46.10% |
| **연속 2개** | 339회 | **56.22%** ⭐ |
| **연속 3개** | 30회 | 4.98% |
| **연속 4개** | 3회 | 0.50% |
| 연속 5개 이상 | 0회 | 0% |

**핵심 인사이트:**
- 절반 이상(53.9%)에서 연속 번호 출현!
- 연속 2개가 가장 흔한 패턴
- 연속 5개 이상은 한 번도 없음

#### 최다 출현 연속 번호 조합 TOP 10

| 순위 | 연속 번호 | 출현횟수 | 출현율(%) | 구간 |
|------|-----------|----------|-----------|------|
| 🥇 | **6-7** | 15회 | 2.49% | 저구간 |
| 🥈 | **38-39** | 14회 | 2.32% | 고구간 |
| 🥈 | **17-18** | 14회 | 2.32% | 중구간 |
| 4 | 3-4 | 12회 | 1.99% | 저구간 |
| 4 | 14-15 | 12회 | 1.99% | 저구간 |
| 6 | 37-38 | 10회 | 1.66% | 고구간 |
| 6 | 40-41 | 10회 | 1.66% | 고구간 |
| 6 | 18-19 | 10회 | 1.66% | 중구간 |
| 6 | 42-43 | 10회 | 1.66% | 고구간 |
| 10 | 1-2, 5-6, 27-28 등 | 9회 | 1.49% | - |

#### 연속 3개 이상 특이 케이스

**연속 3개 최다:**
- **35-36-37**: 3회 출현

**연속 4개 (역사적 사례, 총 3회):**
1. 1118회 (2024.05.04): **13-14-15-16**
2. 783회 (2017.12.02): **14-15-16-17**
3. 655회 (2015.06.20): **37-38-39-40**

#### 실전 활용 전략

✅ **추천 패턴:**
1. 연속 2개 포함 (56% 확률)
2. 빈출 조합: 6-7, 38-39, 17-18
3. 각 구간에서 골고루 선택

⚠️ **주의 패턴:**
1. 연속 3개: 신중하게 (5% 확률)
2. 연속 4개 이상: 피하는 것이 좋음 (0.5% 이하)

❌ **금지 패턴:**
1. 연속 5개 이상: 절대 피할 것 (0% 확률)

---

## 🎯 활용 방법

### 1. 전체 분석 실행
```bash
python main.py
# 메뉴에서 1 선택
```

### 2. 특정 번호 분석
```bash
python main.py
# 메뉴에서 7 선택
# 원하는 번호(1-45) 입력
```

### 3. 개별 모듈 테스트
```bash
# 데이터 로더 테스트
python data_loader.py

# 각 모듈은 독립적으로 테스트 가능
```

---

## 🔬 기술적 특징

### 1. 모듈화 설계
- 각 분석 기능을 독립적인 모듈로 분리
- 재사용성과 유지보수성 향상

### 2. 클래스 기반 구조
- OOP 원칙 적용
- 데이터와 메서드 캡슐화

### 3. 확장 가능성
- 새로운 분석 기능 추가 용이
- 시각화 차트 추가 가능

### 4. 에러 처리
- 인코딩 자동 처리 (UTF-8, CP949)
- 예외 처리를 통한 안정성

### 5. 한글 지원
- 시각화 차트 한글 폰트 설정 (AppleGothic for macOS)
- 출력 메시지 한글 지원

---

## 📝 데이터 구조

### 원본 CSV 컬럼
- year: 연도
- 회차: 로또 회차 번호
- 일자: 추첨 날짜
- 1등~5등 당첨자수
- 1등~5등 당첨액
- 당첨번호#1~#6: 당첨번호 6개
- 당첨번호#7: 보너스 번호

### 전처리 후 데이터
- 숫자 컬럼: float 타입으로 변환
- 날짜: datetime 타입으로 변환
- 당첨번호: 리스트 형태로 구조화

---

## 🚀 향후 개선 방향

### 기능 추가
- [ ] 리포트 자동 생성 (PDF/HTML)
- [ ] 머신러닝 기반 번호 추천 시스템
- [ ] 웹 대시보드 (Streamlit/Dash)
- [ ] 데이터 자동 업데이트 기능
- [ ] 통계적 유의성 검증

### 성능 개선
- [ ] 대용량 데이터 처리 최적화
- [ ] 캐싱 메커니즘 추가
- [ ] 병렬 처리 구현

### UI/UX
- [ ] GUI 버전 개발
- [ ] 인터랙티브 차트 (Plotly)
- [ ] 다국어 지원

---

## ⚠️ 주의사항

1. **확률의 독립성**: 로또는 독립 시행이므로 과거 데이터가 미래 결과를 보장하지 않습니다.
2. **데이터 분석 목적**: 본 프로젝트는 데이터 분석 학습 및 통계적 인사이트 도출을 목적으로 합니다.
3. **책임있는 게임**: 복권은 적정 금액 내에서 즐기시기 바랍니다.

---

## 📚 참고 자료

- Pandas Documentation: https://pandas.pydata.org/docs/
- Matplotlib Documentation: https://matplotlib.org/stable/contents.html
- Seaborn Documentation: https://seaborn.pydata.org/
- 로또 645 공식 홈페이지: https://www.dhlottery.co.kr/

---

## 📞 문의 및 기여

프로젝트 개선 아이디어나 버그 리포트는 이슈로 등록해주세요.

---

## 📄 라이선스

본 프로젝트는 교육 목적으로 작성되었습니다.

---

---

## 🤖 머신러닝 예측 모델 (`prediction_model.py`) ⭐ NEW

### 주요 기능

1. **번호별 특징 추출**
   - 전체 출현 빈도
   - 최근 100회/50회 출현 빈도
   - 마지막 출현 이후 경과 회차
   - 평균 출현 간격 및 표준편차
   - 구간 (저/중/고) 및 홀짝 분류
   - 핫넘버 점수 계산

2. **패턴 학습**
   - **연속 번호 패턴**: 2개/3개 연속 빈도, 출현 확률
   - **구간 패턴**: 가장 흔한 저-중-고 구간 분포
   - **홀짝 패턴**: 가장 흔한 홀짝 개수 조합
   - **합계 패턴**: 평균, 중앙값, 표준편차, 사분위수

3. **번호별 종합 점수 계산**
   - 빈도 점수 (0-30점)
   - 최근 트렌드 점수 (0-30점)
   - 부재 기간 점수 (0-20점)
   - 핫넘버 점수 (0-20점)
   - **총점**: 최대 100점

4. **확률 가중치 계산**
   - 점수 기반 확률 분포 생성
   - 샘플링에 활용

### 클래스 및 메서드

**클래스:** `LottoPredictionModel`

**주요 메서드:**
- `extract_number_features()`: 45개 번호 특징 추출
- `analyze_consecutive_patterns()`: 연속 번호 학습
- `analyze_section_patterns()`: 구간 패턴 학습
- `analyze_odd_even_patterns()`: 홀짝 패턴 학습
- `analyze_sum_patterns()`: 합계 패턴 학습
- `calculate_number_scores()`: 번호별 종합 점수 계산
- `train_all_patterns()`: 모든 패턴 학습 실행
- `get_top_numbers(n)`: 상위 N개 번호 반환
- `get_probability_weights()`: 확률 가중치 반환

### 실행 방법

```bash
cd src
source ../venv/bin/activate
python prediction_model.py
```

---

## 🎯 번호 추천 시스템 (`recommendation_system.py`) ⭐ NEW

### 7가지 추천 전략 (v4.0.0 업데이트)

#### 1. ⭐ 하이브리드 추천 (최고 품질)
- 점수, 확률, 패턴, **그리드** 전략 결합 (4가지)
- 중복 제거 후 재점수 계산
- 최고 점수 조합 선정

#### 2. 📊 점수 기반 추천
- 상위 20개 번호 활용
- 무작위 샘플링 후 점수 계산
- 점수 순 정렬

#### 3. 🎲 확률 가중치 추천
- 점수 기반 확률 분포로 샘플링
- `numpy.random.choice` 가중치 적용

#### 4. 🔄 패턴 기반 추천
- 가장 흔한 구간 분포 목표
- 가장 흔한 홀짝 분포 목표
- 패턴 매칭 조합 생성

#### 5. 🎨 그리드 패턴 기반 추천 ⭐ NEW (v4.0.0)
- **중간 영역 우선 선택** (3-4개)
- **반대 대각선 활용** (1-2개)
- **모서리 번호 제외**
- **평균 거리 4.0~5.5 유지**
- 그리드 점수 기반 정렬

**그리드 가중치:**
- 중간 영역: **1.46x** (출현율 가장 높음)
- 중앙부: 1.09x
- 가장자리: 0.91x
- 모서리: **0.83x** (출현율 가장 낮음)

**보너스 시스템:**
- 중간 영역 3-4개: +20점
- 반대 대각선 1-2개: +15점
- 평균 거리 4.0~5.5: +20점
- 모서리 2개 이상: -15점 (페널티)

#### 6. 🔢 연속 번호 포함 추천
- 인기 연속 쌍 활용 (6-7, 38-39 등)
- 연속 쌍 포함 후 나머지 채우기

#### 7. 🎰 무작위 추천 (대조군)
- 순수 랜덤 생성
- 비교 기준

### 검증 기능

**기본 검증:**
- 개수 6개
- 범위 1-45
- 중복 없음

**엄격한 검증 (strict=True):**
- 한 구간에 5개 이상 제외
- 홀0:짝6 또는 홀6:짝0 제외
- 연속 4개 이상 제외

### 조합 점수 계산 (v4.0.0 업데이트)

**기본 점수:**
- 개별 번호 점수 합
- 연속 번호 보너스: +10점
- 균형 구간 분포 보너스: +15점
- 홀짝 균형 보너스: +10점
- 합계 범위 (평균±표준편차) 보너스: +10점

**그리드 패턴 보너스 (NEW):**
- 위치 기반 가중치 (중간 영역 우대)
- 중간 영역 3-4개: +20점
- 반대 대각선 1-2개: +15점
- 평균 거리 4.0~5.5: +20점
- 모서리 2개 이상: -15점
- **그리드 점수 x 0.5** 가중치로 총점에 통합

### 클래스 및 메서드

**클래스:** `LottoRecommendationSystem`

**주요 메서드:**
- `generate_by_score(n_combinations)`: 점수 기반 추천
- `generate_by_probability(n_combinations)`: 확률 가중치 추천
- `generate_by_pattern(n_combinations)`: 패턴 기반 추천
- `generate_grid_based(n_combinations)`: 그리드 패턴 기반 추천 ⭐ NEW
- `generate_hybrid(n_combinations)`: 하이브리드 추천 (4가지 전략 통합)
- `generate_with_consecutive(n_combinations)`: 연속 번호 포함
- `generate_random(n_combinations)`: 무작위 추천
- `generate_all_strategies(n_per_strategy)`: 모든 전략 실행

**그리드 패턴 관련 메서드 (NEW):**
- `_init_grid_pattern_data()`: 그리드 구역 및 가중치 초기화
- `_get_grid_zone(number)`: 번호의 그리드 구역 반환
- `_calculate_grid_score(numbers)`: 그리드 패턴 점수 계산
- `_calculate_spatial_distance(numbers)`: 번호 간 평균 거리 계산

### 실행 방법

```bash
cd src
source ../venv/bin/activate
python recommendation_system.py
```

**출력 예시:**
```
🎯 로또 645 번호 추천 시스템
==========================================

⭐ 하이브리드 추천 (최고 품질)
  1. [3, 7, 16, 21, 33, 39] (점수: 487.3, 합: 119, 홀3/짝3)
  ...

📊 점수 기반 추천
  1. [6, 12, 19, 21, 33, 38] (점수: 512.1)
  ...
```

---

## 🌐 Streamlit 웹 애플리케이션 (`web_app.py`) ⭐ NEW

### 개요

Streamlit 기반 인터랙티브 웹 인터페이스로, 모든 분석 및 추천 기능을 웹 브라우저에서 사용 가능합니다.

### 주요 페이지

#### 1. 🏠 홈
- 프로젝트 소개
- 데이터 요약 (총 회차, 평균 당첨금, 최다 번호 등)
- 최근 10회 당첨번호 테이블

#### 2. 📊 데이터 탐색

**기본 통계 탭:**
- 번호별 출현 빈도 차트 (Plotly 인터랙티브)
- 구간별 분포 파이 차트
- 홀짝 분포 파이 차트

**시계열 분석 탭:**
- 최근 50회 핫넘버/콜드넘버 TOP 10
- 번호별 미출현 기간 차트
- 장기 미출현 번호 TOP 15

**패턴 분석 탭:**
- 연속 번호 패턴 분포 차트
- 연속 길이별 출현 빈도 및 비율

#### 3. 🎯 번호 추천

**기능:**
- 추천 개수 선택 (1-10개)
- 6가지 전략 중 선택
- 번호 생성 버튼

**출력:**
- 시각적 번호 카드 (구간별 색상)
- 각 조합의 통계 (합계, 홀짝, 구간 분포, 연속 번호)
- 추천 번호 전체 통계 (가장 많이 추천된 번호, 평균 합계, 연속 비율)

#### 4. 🔍 번호 분석

**기능:**
- 1-45 중 번호 선택
- 분석하기 버튼

**출력:**
- 총 출현 횟수, 최근 50회 출현, 미출현 기간, 종합 점수
- 점수 분해 차트 (빈도/트렌드/부재/핫넘버)
- 최근 출현 이력 TOP 10
- 자주 함께 나온 번호 TOP 10

#### 5. 🤖 예측 모델

**출력:**
- 점수 기반 상위 20개 번호 차트
- 가장 흔한 구간 분포 TOP 5
- 가장 흔한 홀짝 분포
- 당첨번호 합계 통계 (평균, 중앙값, 표준편차, 범위)
- 연속 번호 출현 확률
- 인기 연속 쌍 TOP 10

#### 6. 🎨 그리드 패턴 ⭐ NEW

**기능:**
- 7x7 그리드 위치별 출현 빈도 히트맵
- 구역별 분포 분석 (모서리/가장자리/중간/중앙부)
- 기하학적 패턴 (대각선, 같은 줄)
- 공간적 군집도 분포

**출력:**
- 위치별 출현 빈도 히트맵 (각 셀에 번호와 빈도 표시)
- 최다/최소/평균 출현 통계
- 구역별 출현 통계 테이블
- 대각선 패턴 비교
- 같은 줄 패턴 통계
- 공간적 군집도 차트 (히스토그램)
- 실전 활용 전략 (추천/주의)
- 그리드 기반 추천 번호

### 사이드바

- 메뉴 선택 (6개 페이지) ⭐
- 데이터 정보 표시
- 주의사항 안내

### 캐싱 최적화

- `@st.cache_data`: 데이터 로딩 캐싱
- `@st.cache_resource`: 모델 학습 결과 캐싱
- 빠른 재실행 및 성능 향상

### 실행 방법

**자동 스크립트:**
```bash
./run_web.sh
```

**수동 실행:**
```bash
source venv/bin/activate
cd src
streamlit run web_app.py
```

**접속 URL:** `http://localhost:8501`

### 기술 스택

- **Streamlit**: 웹 프레임워크
- **Plotly**: 인터랙티브 차트
- **Pandas/NumPy**: 데이터 처리
- **scikit-learn**: 머신러닝

---

## 📦 업데이트된 패키지 목록 (`requirements.txt`)

```
# 데이터 처리
pandas>=2.0.0
numpy>=1.24.0

# 시각화
matplotlib>=3.7.0
seaborn>=0.12.0

# 머신러닝 ⭐ NEW
scikit-learn>=1.3.0

# 웹 인터페이스 ⭐ NEW
streamlit>=1.28.0
plotly>=5.17.0

# 추가 유틸리티
openpyxl>=3.1.0
```

---

**작성자**: Claude AI (Anthropic)
**작성일**: 2025-12-27
**최종 업데이트**: 2025-12-28 (v4.0.0 완료)
**버전**: 4.0.0

**주요 업데이트 내역:**

**v4.0.0 (2025-12-28):** ⭐ 그리드 패턴 분석 추가
- 🎨 그리드 패턴 분석 모듈 추가 (`grid_pattern_analysis.py`)
- 🖼️ 복권 용지 이미지 생성 시스템 (`generate_lottery_ticket.py`, `batch_generate_tickets.py`)
- 📊 그리드 패턴 차트 3개 추가 (총 18개 차트)
- 🌐 웹 앱에 그리드 패턴 페이지 추가 (6페이지)
- 🎯 그리드 기반 번호 추천 전략 개발
- 📝 그리드 패턴 분석 리포트 작성
- 🔍 위치별/구역별/군집도 분석
- 📈 기하학적 패턴 (대각선, 라인) 분석
- 🖼️ 604개 복권 용지 이미지 생성 완료

**v3.0.0 (2025-12-27):** ⭐ 대규모 업데이트
- 🤖 머신러닝 예측 모델 추가 (`prediction_model.py`)
- 🎯 6가지 전략 기반 번호 추천 시스템 (`recommendation_system.py`)
- 🌐 Streamlit 웹 애플리케이션 구축 (`web_app.py`)
- 📊 인터랙티브 Plotly 차트 통합
- 🚀 웹 앱 실행 스크립트 (`run_web.sh`)
- 📝 README.md 사용자 가이드 작성
- 📦 패키지 업데이트 (scikit-learn, streamlit, plotly)

**v2.0.0 (2025-12-27):**
- ⭐ 연속 번호 상세 분석 모듈 추가 (`consecutive_analysis.py`)
- 📊 시각화 차트 15개로 확장 (기존 6개 → 15개)
- 📈 시계열 분석 차트 3개 추가
- 🔍 조합 패턴 히트맵 추가
- 💰 당첨금 분석 차트 2개 추가
- 🔢 연속 번호 전용 차트 3개 추가
